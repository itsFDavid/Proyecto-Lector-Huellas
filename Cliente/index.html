<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comunicación WebSocket con Arduino</title>
</head>
<body>
  <button id="conectar" onclick="conectarArduino()">Conectar Arduino</button>
  <div id="output"></div>
  <input type="text" id="comando" placeholder="Ingrese un comando">
  <button onclick="enviarComando()">Enviar Comando</button>

  <script>
    const ws = new WebSocket('ws://localhost:8080');

    let mensajeParcial = '';

    ws.onopen = function() {
    console.log('Conexión establecida con el servidor WebSocket');
    document.getElementById('conectar').disabled = true;
    };

    ws.onmessage = function(event) {
    const data = event.data.toString();
    mensajeParcial += data;

    // Verificar si se recibió el carácter de terminación '\n'
    if (data.includes('\n')) {
        console.log('Mensaje recibido desde el servidor:', mensajeParcial);
        document.getElementById('output').textContent = mensajeParcial;
        mensajeParcial = ''; // Limpiar el mensaje parcial para el próximo mensaje
    }
    };

    function enviarComando() {
    const comando = document.getElementById('comando').value;
    ws.send(comando);
    }

  </script>
</body>
</html>
